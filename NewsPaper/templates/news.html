{% extends 'flatpages/default.html' %}
{% load custom_filters %}

{% block content %}

<style>
html, body { height:100%; margin:0; }
.page-container { display:flex; flex-direction:column; min-height:100vh; }
.content { flex:1; padding-bottom:70px; }
.pagination-container {
    position: fixed; bottom:0; left:0; width:100%;
    background:#f1f1f1; text-align:center; padding:10px 0;
    box-shadow:0 -2px 5px rgba(0,0,0,0.1); z-index:1000;
}
</style>

<div class="page-container">

    <div class="content">
        {% if news %}
            <h1 style="text-align: left;">Всего новостей: {{ total_news }}</h1>
            <table>
                <tr>
                    <td>Заголовок</td>
                    <td>Дата</td>
                    <td>Предпросмотр</td>
                </tr>
                {% for item in news %}
                <tr>
                    <td>
                        <a href="{% url 'post' item.id %}">{{ item.title|censor }}</a>
                        <a href="{% url 'post_update' item.id %}"><u>Редактировать</u></a> <!-- добавим ссылку на редактирование поста-->
                        <a href="{% url 'post_delete' item.id %}"><u> Удалить </u></a> <!-- добавим ссылку на удаление поста-->
                    </td>
                    <td>{{ item.date_time|date:'d M Y' }}</td>
                    <td>{{ item.text|truncatewords:20|censor }}</td>
                </tr>
                {% endfor %}
            </table>
        {% else %}
            <h1>Новостей нет!</h1>
        {% endif %}
    </div>

    <div class="pagination-container">
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">

                {% if page_obj.number > 1 %}
                    <li class="page-item"><a class="page-link" href="?page=1">Первая</a></li>
                {% endif %}

                {% if page_obj.has_previous %}
                    <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">⮜</a></li>
                {% endif %}

                {% for num in page_obj.paginator.page_range %}
                    {% if num == page_obj.number %}
                        <li class="page-item active"><span class="page-link">{{ num }}</span></li>
                    {% elif num >= page_obj.number|add:-2 and num <= page_obj.number|add:2 %}
                        <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
                    {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                    <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">⮞</a></li>
                {% endif %}

                {% if page_obj.number < page_obj.paginator.num_pages %}
                    <li class="page-item"><a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">Последняя</a></li>
                {% endif %}

            </ul>
        </nav>
    </div>

</div>

{% endblock content %}
